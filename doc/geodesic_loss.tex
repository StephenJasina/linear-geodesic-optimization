\section{Geodesic Loss}

We will define the following in this section: \begin{center}\begin{tabular}{r|l}
	\(t\) & Vector of RTTs in \(\mathbb{R}^{\abs{E_G}}\) \\ \hline
	\(\mathbf{1}\) & Vector of all ones in \(\mathbb{R}^{\abs{E_G}}\) \\ \hline
	\(\nu_0\) & Intermediate value \\ \hline
	\(\nu_1\) & Intermediate value \\ \hline
	\(\delta\) & Intermediate value \\ \hline
	\(\beta_0\) & The constant term in the least squares linear estimator between \(\phi\) and \(t\) \\ \hline
	\(\beta_1\) & The linear term in the least squares linear estimator between \(\phi\) and \(t\) \\ \hline
	\(\mathcal{L}_{\mathrm{geodesic}}\pof{M}\) & The sum of squared residuals when using \(\beta\) as an estimator, scaled to be unitless
\end{tabular}\end{center}

\subsection{Forward Computation}
We make the following computations: \begin{align*}
	\nu_0 &= \pof{\mathbf{1}^\intercal t}\pof{\phi^\intercal\phi} - \pof{t^\intercal\phi}\pof{\mathbf{1}^\intercal\phi}, \\
	\nu_1 &= \abs{E_G}t^\intercal\phi - \pof{\mathbf{1}^\intercal\phi}\pof{\mathbf{1}^\intercal t}, \\
	\delta &= \abs{E_G}\phi^\intercal\phi - \pof{\mathbf{1}^\intercal\phi}^2, \\
	\beta_0 &= \frac{\nu_0}{\delta}, \\
	\beta_1 &= \frac{\nu_1}{\delta}, \\
	\mathcal{L}_{\mathrm{geodesic}}\pof{M} &= \frac{1}{t^\intercal t}\norm{t - \pof{\beta_0\mathbf{1} + \beta_1\phi}}_2^2. \\
\end{align*}

\subsection{Reverse Computation}
The partials of the above quantities are as follows: \begin{align*}
	\frac{\partial\nu_0}{\partial z_\ell} &= \pof{2\pof{\mathbf{1}^\intercal t}\phi - \pof{\mathbf{1}^\intercal\phi}t - \pof{t^\intercal\phi}\mathbf{1}}^\intercal\frac{\partial\phi}{\partial z_\ell}, \\
	\frac{\partial\nu_1}{\partial z_\ell} &= \pof{\abs{E_G} - \pof{\mathbf{1}^\intercal t}\mathbf{1}}^\intercal\frac{\partial\phi}{\partial z_\ell}, \\
	\frac{\partial\delta}{\partial z_\ell} &= 2\abs{E_G}\phi^\intercal\frac{\partial\phi}{\partial z_\ell}, \\
	\frac{\partial\beta_0}{\partial z_\ell} &= \frac{1}{\delta}\pof{\frac{\partial\nu_0}{\partial z_\ell} - \beta_0\frac{\partial\delta}{\partial z_\ell}}, \\
	\frac{\partial\beta_1}{\partial z_\ell} &= \frac{1}{\delta}\pof{\frac{\partial\nu_1}{\partial z_\ell} - \beta_1\frac{\partial\delta}{\partial z_\ell}}, \\
	\frac{\partial\pof{\mathcal{L}_{\mathrm{geodesic}}\pof{M}}}{\partial z_\ell} &= -\frac{2}{t^\intercal t}\pof{t - \pof{\beta_0\mathbf{1} + \beta_1\phi}}\pof{\frac{\partial\beta_1}{\partial z_\ell}\phi + \beta_1\frac{\partial\phi}{\partial z_\ell}}.
\end{align*}
